<!DOCTYPE html>
<html lang="pl">
<head>
<title>Galaktyczne Biznesy</title>
<meta charset="utf-8" />
<link rel="stylesheet" href="globalne.css">
<link rel="stylesheet" href="kolory.css">
<link rel="stylesheet" href="mapa.css">
<script src="funkcjeTla.js"></script>
<script src="funkcjeMenu.js"></script>
<script src="funkcjeRysowania.js"></script>
<script type="text/javascript">
	const polozenie=[[350,350]]
	let widoczneUklady=[]
	let zapisaneUklady=[]
	function start()
	{
		tlo.zaladuj()
		menu.zaladuj()
		document.getElementById("kontent").appendChild(ekran.mapa.div)
		document.getElementById("kontent").appendChild(ekran.uklad.div)
		setTimeout(()=>{menu.guziki[0][2].odswiez({aktywny:1,menu:'test',zaznaczony:1})},4000)
		setTimeout(()=>{zaznaczUklad(352,352)},2000)
	}
	class Ekran
	{
	    constructor(nazwa)
	    {
	    	this.obraz={d:1000,h:1000,elementy:[{typ:0,kolor:"#f7391b",srodek:[550,450],promien:400,zakresKatow:[0.2,1.22],grubosc:27,kolorLini:"green"}]}//do test√≥w
	    	this.stan=0
	    	this.div=document.createElement("div")
	    	this.div.className="ekran"
	    	this.div.id=`ekran-${nazwa}`
	    	//
	    	this.narozniki=[]
	    	for (let i=0 ; i<4 ; i++)
	    	{
	    		const naroznik={}
	    		naroznik.div=document.createElement("div")
	    		naroznik.div.style.position="absolute"
	    		naroznik.div.style.transition="0.5s"
	    		naroznik.div.style.width="15%"
	    		naroznik.div.style.height="15%"
	    		naroznik.strony=[]
	    		naroznik.strony.push(`${["Left","Right"][i%2]}`)
	    		naroznik.strony.push(`${["Top","Bottom"][Math.floor(i/2)]}`)
	    		for (const strona of naroznik.strony)
	    		{
	    			naroznik.div.style[`border${strona}`]=`solid 0.5vh var(--podstawowy1)`
	    		}
	    		for (const strona of naroznik.strony)
	    		{
	    			naroznik.div.style[strona.toLowerCase()]=[`42%`,"-0.7%"][this.stan]
	    		}
	    		this.narozniki.push(naroznik)
	    		this.div.appendChild(naroznik.div)
	    	}
	    	this.canvas=document.createElement("canvas")
	    	this.canvas.style.transition="0.3s"
			this.canvas.className="ekran-canvas"
			this.canvas.id=`${nazwa}-canvas`
			this.canvas.style.opacity=this.stan
			this.div.appendChild(this.canvas)
	    }
	    zamknij()
	    {
	    	this.stan=0
	    	this.dopasujStan()
	    }
	    otworz()
	    {
	    	this.stan=1
	    	this.dopasujStan()
	    }
	    dopasujStan()
	    {
	    	setTimeout(()=>{this.canvas.style.opacity=this.stan},[1,150][this.stan])
	    	if (this.stan)
	    	{
	    		rysuj(this.canvas,this.obraz)
	    	}
	    	for (const naroznik of this.narozniki)
	    	{
	    		for (const strona of naroznik.strony)
	    		{
	    			setTimeout(()=>{naroznik.div.style[strona.toLowerCase()]=[`42%`,"-0.7%"][this.stan]},[100,1][this.stan])
	    		}
	    	}
	    }
	    odswiez()
	    {
	    	this.zamknij()
	    	setTimeout(()=>{this.otworz()},600)
	    }
	}
	const ekran=
	{
		mapa: new Ekran("mapa"),
		uklad: new Ekran("uklad"),
	}
	function zaznaczUklad(y,x)
	{
		polozenie.unshift([y,x])
		ekran.mapa.zamknij()
		pokazMape()
	}
	function pokazMape()
	{
		widoczneUklady=[]
		for (let y=0 ; y<5 ; y++)
		{
			for (let x=0 ; x<5 ; x++)
			{
				const Y=polozenie[0][0]-2+y
				const X=polozenie[0][1]-2+x
				const uklad=szukajUkladu(Y,X)
				if (uklad)
				{
					uklad.Ywidok=(70+(140*y))+([0,-40,-40,-40,0,0,0,40,40,40,0][uklad.przesuniecie]||0)+[-10,0,10,0,10,-10,0][((Y+X)%6)]
					uklad.Xwidok=(70+(140*x))+([0,-40,0,40,-40,0,40,-40,0,40,0][uklad.przesuniecie]||0)+[0,10,-10,-10,0,10,0][((Y+X)%6)]
					widoczneUklady.push(uklad)
				}
				else
				{
					return setTimeout(pokazMape,500)
				}
			}
		}
		const elementy=[]
		elementy.push({typ:1,punkty:[[14,686],[686,686],[686,14],[14,14]],grubosc:27,kolorLini:"#253911",krycie:0.2})
		if (true)
		{
			for (let a=0 ; a<9 ; a++)
			{
				const element={typ:1,punkty:[],grubosc:2,kolorLini:"#253911"}
				element.punkty.push([27,27+(a*38)])
				element.punkty.push([27,673-(a*38)])
				element.punkty.push([673,673-(a*38)])
				element.punkty.push([673,27+(a*38)])
				elementy.push(element)
			}
			for (let a=0 ; a<9 ; a++)
			{
				const element={typ:1,punkty:[],grubosc:2,kolorLini:"#253911"}
				element.punkty.push([27+(a*38),27])
				element.punkty.push([673-(a*38),27])
				element.punkty.push([673-(a*38),673])
				element.punkty.push([27+(a*38),673])
				elementy.push(element)
			}
		}
		for (let uklad of widoczneUklady)
		{
			elementy.push({typ:0,kolor:uklad.kolor,srodek:[uklad.Ywidok,uklad.Xwidok],promien:(uklad.wielkosc*1.5),rozmycie:(uklad.wielkosc*2),krycie:1})
			elementy.push({typ:0,kolor:uklad.kolor,srodek:[uklad.Ywidok,uklad.Xwidok],promien:uklad.wielkosc*1})
		}
		ekran.mapa.obraz={h:700,d:700,elementy:elementy}
		ekran.mapa.otworz()
	}
	function szukajUkladu(y,x)
	{
		return {wielkosc:Math.floor(Math.random()*9)+1,kolor:`hsl(${0+Math.floor(Math.random()*60)},${Math.floor(Math.random()*10)+90}%,${Math.floor(Math.random()*50)+50}%)`,nazwa:"test",przesuniecie:Math.floor(Math.random()*9)+1}
	}
</script>
</head>
<body onload="start()">
	<div id="tlo"></div>
	<div id="kontent"></div>
	<div id="sztucznaStopka"></div>
	<div class="pas" id="pas1"><div class="kontentPas"></div></div></div>
	<div class="pas" id="pas2"><div class="kontentPas"></div></div></div>
	<div id="oknoMenu"><div id="tloMenu"></div><div id="ramyMenu"><div id="ramaMenu1"></div><div id="ramaMenu2"></div></div><div id="kontentMenu"></div></div>
</body>
</html>
